<ion-view view-title="交易历史" hide-nav-bar="{{ iswecat }}">
    <ion-nav-buttons side="right">
        <button class="button hide" ng-click="toggleRightSideMenu()">
            筛选
        </button>
    </ion-nav-buttons>
    <ion-content class="trade_history" scroll="false">
        <header>
            <article ng-click="change_category(0)" ng-class="{ 'active' : category_index === 0 }"> 
            	<p>
            		持仓明细
            	</p>
            </article>
            <article ng-click="change_category(1)" ng-class="{ 'active' : category_index === 1 }">
            	<p>
            		历史明细
            	</p>
            </article>
        </header>

        <ion-slide-box delegate-handle="slide-history" on-slide-changed="slide_change($index)" 
        show-pager="false" active-slide="category_index" class="trade_history_list">
            <ion-slide>
            	<ul>
            		<ion-scroll style="height: 100%">
                        <ion-refresher pulling-text="上拉刷新数据" on-refresh="refresh_order()">
                        </ion-refresher>
                        <li ng-repeat="o in order_list" ng-click="show_hold_order_modal(o);">
                        	<section>
                            	<p>
                            		<span>{{o.assets.name}}</span>
                            		<span ng-class="{'in_money':o.direction === 1,'out_money':o.direction === 0}"><i ng-class="{'buytop':o.direction === 1,'buydown':o.direction === 0}"></i>{{o.direction === 1 ?"买涨":"买跌"}}（{{currency_symbol}}{{o.money}}）</span>
                            	</p>
                            	<p>
                            		{{o.buyQoute}}-<span ng-class="{'in_money':o.direction === 1,'out_money':o.direction === 0}">{{ o.qoute.value.toFixed(o.qoute.decimal) }}</span>
                            	</p>
                            	<p>{{o.created|date:'yyyy-MM-dd HH:mm:ss'}}</p>
                            </section><section>
		                    	<p style="margin: 0" ng-class="{'in_money':(o.direction == '0' && o.qoute.value < o.buyQoute) || (o.direction == '1' && o.qoute.value > o.buyQoute) ,'out_money':(o.direction == '1' && o.qoute.value < o.buyQoute) || (o.direction == '0' && o.qoute.value > o.buyQoute)}">{{(o.direction == '0'  && o.qoute.value > o.buyQoute) || (o.direction == '1' && o.qoute.value  < o.buyQoute)? o.profit - o.money: o.profit + o.money}}</p>
		                    	<p style="margin: 0">{{o.remaining*1000-28800000>86400000?(((o.remaining*1000-28800000)/86400000|number:0) +'天'+(o.remaining*1000-28800000|date:'HH:mm:ss')):(o.remaining*1000-28800000|date:'HH:mm:ss')}}</p>
		                	</section>
                            <article ng-hide="o.remaining === 0">
                    		<span class="move_width" ng-style="{'width':o.remaining*100000/o.alltime-2+'%','transition-duration':1+'s'}">
                    		</span>
                    		<i>
                    			<em></em>
                    		</i>
                    		</article>
                        </li>
                        <ion-infinite-scroll ng-if="has_more_order" on-infinite="load_more_order()" distance="1%">
                        </ion-infinite-scroll>
                    </ion-scroll>
            	</ul>
            </ion-slide>
            <ion-slide>
                <ul>
                	<ion-scroll style="height: 100%">
                            <ion-refresher pulling-text="上拉刷新数据" on-refresh="refresh_close_order()">
                            </ion-refresher>
                            <li ng-repeat="o in close_order_list" ng-click="show_close_order_modal(o);">
                                <section>
                                	<p>
                                		<span>{{o.assets.name}}</span>
                                		<span ng-class="{'in_money':o.profit>0,'out_money':o.profit<0}"><i ng-class="{'buytop':o.direction === 1,'buydown':o.direction === 0}"></i>{{o.direction === 1 ?"买涨":"买跌"}}（{{currency_symbol}}{{o.money}}）</span>
                                	</p>
                                	<p>
                                		{{o.buyQoute}}-<span ng-class="{'in_money':o.profit>0,'out_money':o.profit<0}">{{o.endQoute}}</span>
                                	</p>
                                	<p>{{o.created|date:'yyyy-MM-dd HH:mm:ss'}}</p>
                                </section><section>
                                	<p ng-class="{'in_money':o.profit>0,'out_money':o.profit<0}">{{o.profit>0?"+"+o.profit:o.profit}}</p>
                                	<p>{{o.closed|date:'yyyy-MM-dd HH:mm:ss'}}</p>
                                </section>
                            </li>
                            <ion-infinite-scroll ng-if="has_more_close_order" on-infinite="load_more_close_order()" distance="1%">
                            </ion-infinite-scroll>
                        </ion-scroll>
                </ul>
            </ion-slide>
        </ion-slide-box>
    </ion-content>
</ion-view>
